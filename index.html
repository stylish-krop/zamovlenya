<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Відкриваємо Viber</title>
  <style>
    body {
      font-family: system-ui, Arial, Helvetica, sans-serif;
      background: #f3f4f8;
      margin: 0;
      padding: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    .card {
      width: 100%;
      max-width: 480px;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      text-align: center;
    }
    h1 {
      font-size: 20px;
      margin: 6px 0 8px;
    }
    p {
      color: #333;
      font-size: 15px;
    }
    button {
      padding: 12px 18px;
      border-radius: 10px;
      border: 0;
      font-size: 16px;
      cursor: pointer;
    }
    .open {
      background: #7360f2;
      color: white;
    }
    .secondary {
      margin-top: 12px;
      font-size: 14px;
      color: #555;
    }
    a.small {
      color: #2563eb;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>Відкриваємо Viber</h1>
    <p id="status">Спроба автоматично відкрити Viber…</p>

    <div style="margin-top:12px">
      <button id="openBtn" class="open">Написати в Viber</button>
    </div>
    <p class="secondary">
      Якщо Viber не встановлено — натисніть нижче «Встановити Viber».
    </p>
    <p class="secondary">
      <a id="installLink" class="small" href="#" target="_blank" rel="noopener">Встановити Viber</a>
    </p>
  </div>

<script>
  // ====== Налаштування ======
  const CHAT_URI = '';                  // залишаємо порожнім (використовуємо номер)
  const PHONE_E164 = '+380975503559';   // твій номер
  const UTM = 'utm_source=tiktok&utm_medium=bio'; // для аналітики
  // ===========================

  const status = document.getElementById('status');
  const openBtn = document.getElementById('openBtn');
  const installLink = document.getElementById('installLink');

  const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
  const storeUrl = isIOS
    ? 'https://apps.apple.com/app/id382617920'
    : 'https://play.google.com/store/apps/details?id=com.viber.voip';
  installLink.href = storeUrl;

  function getDeepLink() {
    if (CHAT_URI && CHAT_URI.trim() !== '') {
      return 'viber://pa?chatURI=' + encodeURIComponent(CHAT_URI);
    }
    if (PHONE_E164 && PHONE_E164.trim() !== '') {
      return 'viber://chat?number=' + encodeURIComponent(PHONE_E164);
    }
    return null;
  }

  function tryOpen() {
    const deep = getDeepLink();
    if (!deep) {
      status.textContent = 'Посилання Viber не налаштоване. Зверніться до адміністратора.';
      return;
    }
    const url = deep + (UTM ? (deep.includes('?') ? '&' : '?') + UTM : '');
    status.textContent = 'Переадресація… Якщо нічого не сталося — натисніть кнопку нижче.';
    window.location = url;

    setTimeout(() => {
      status.textContent = 'Не відкрився Viber? Натисніть «Написати в Viber» або встановіть додаток.';
    }, 1200);
  }

  window.addEventListener('load', tryOpen);
  openBtn.addEventListener('click', tryOpen);
</script>
</body>
</html>
